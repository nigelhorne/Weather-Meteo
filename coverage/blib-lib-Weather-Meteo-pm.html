<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="https://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.51
Devel::Cover is copyright 2001-2025, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
https://pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: blib/lib/Weather/Meteo.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">blib/lib/Weather/Meteo.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">69.8%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s">package Weather::Meteo;</td></tr>
<tr><td class="h">2</td><td colspan="6"></td></tr><tr><td class="h">3</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L3">6</a></div></td><td><div>509914</div><div>2</div><div>78</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">4</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L4">6</a></div></td><td><div>9</div><div>5</div><div>93</div></td><td class="s">use warnings;</td></tr>
<tr><td class="h">5</td><td colspan="6"></td></tr><tr><td class="h">6</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L6">6</a></div></td><td><div>9</div><div>5</div><div>132</div></td><td class="s">use Carp;</td></tr>
<tr><td class="h">7</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L7">6</a></div></td><td><div>1278</div><div>163871</div><div>81</div></td><td class="s">use CHI;</td></tr>
<tr><td class="h">8</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L8">6</a></div></td><td><div>18</div><div>1</div><div>140</div></td><td class="s">use JSON::MaybeXS;</td></tr>
<tr><td class="h">9</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L9">6</a></div></td><td><div>1926</div><div>114809</div><div>98</div></td><td class="s">use LWP::UserAgent;</td></tr>
<tr><td class="h">10</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L10">6</a></div></td><td><div>1236</div><div>257536</div><div>125</div></td><td class="s">use Object::Configure;</td></tr>
<tr><td class="h">11</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L11">6</a></div></td><td><div>20</div><div>41</div><div>92</div></td><td class="s">use Params::Get 0.13;</td></tr>
<tr><td class="h">12</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L12">6</a></div></td><td><div>12</div><div>4</div><div>74</div></td><td class="s">use Return::Set;</td></tr>
<tr><td class="h">13</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L13">6</a></div></td><td><div>10</div><div>3</div><div>58</div></td><td class="s">use Scalar::Util;</td></tr>
<tr><td class="h">14</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L14">6</a></div></td><td><div>10</div><div>1</div><div>15</div></td><td class="s">use Time::HiRes;</td></tr>
<tr><td class="h">15</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L15">6</a></div></td><td><div>182</div><div>2</div><div>61</div></td><td class="s">use URI;</td></tr>
<tr><td class="h">16</td><td colspan="6"></td></tr><tr><td class="h">17</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L17">6</a></div></td><td><div>7</div><div>9</div><div>147</div></td><td class="s">use constant FIRST_YEAR =&gt; 1940;</td></tr>
<tr><td class="h">18</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L18">6</a></div></td><td><div>10</div><div>2</div><div>106</div></td><td class="s">use constant EXPIRES_IN =&gt; &#39;1 hour&#39;;</td></tr>
<tr><td class="h">19</td><td><div class="c3">6</div><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L19">6</a></div></td><td><div>18</div><div>5</div><div>3479</div></td><td class="s">use constant MIN_INTERVAL =&gt; 0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# default: no rate-limiting delay</td></tr>
<tr><td class="h">20</td><td colspan="6"></td></tr><tr><td class="h">21 - 29</td><td colspan="5"></td><td class="s"><pre>=head1 NAME

Weather::Meteo - Interface to L&lt;https://open-meteo.com&gt; for historical weather data

=head1 VERSION

Version 0.12

=cut</pre></td></tr>
<tr><td class="h">30</td><td colspan="6"></td></tr><tr><td class="h">31</td><td></td><td></td><td></td><td></td><td></td><td class="s">our $VERSION = &#39;0.12&#39;;</td></tr>
<tr><td class="h">32</td><td colspan="6"></td></tr><tr><td class="h">33 - 121</td><td colspan="5"></td><td class="s"><pre>=head1 SYNOPSIS

The C&lt;Weather::Meteo&gt; module provides an interface to the Open-Meteo API for retrieving historical weather data from 1940.
It allows users to fetch weather information by specifying latitude, longitude, and a date.
The module supports object-oriented usage and allows customization of the HTTP user agent.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;use Weather::Meteo;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $meteo = Weather::Meteo-&gt;new();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $weather = $meteo-&gt;weather({ latitude =&gt; 0.1, longitude =&gt; 0.2, date =&gt; &#39;2022-12-25&#39; });

=over 4

=item * Caching

Identical requests are cached (using L&lt;CHI&gt; or a user-supplied caching object),
reducing the number of HTTP requests to the API and speeding up repeated queries.

This module leverages L&lt;CHI&gt; for caching geocoding responses.
When a geocode request is made,
a cache key is constructed from the request.
If a cached response exists,
it is returned immediately,
avoiding unnecessary API calls.

=item * Rate-Limiting

A minimum interval between successive API calls can be enforced to ensure that the API is not overwhelmed and to comply with any request throttling requirements.

Rate-limiting is implemented using L&lt;Time::HiRes&gt;.
A minimum interval between API
calls can be specified via the C&lt;min_interval&gt; parameter in the constructor.
Before making an API call,
the module checks how much time has elapsed since the
last request and,
if necessary,
sleeps for the remaining time.

=back

=head1 METHODS

=head2 new

&nbsp;&nbsp;&nbsp;&nbsp;my $meteo = Weather::Meteo-&gt;new();
&nbsp;&nbsp;&nbsp;&nbsp;my $ua = LWP::UserAgent-&gt;new();
&nbsp;&nbsp;&nbsp;&nbsp;$ua-&gt;env_proxy(1);
&nbsp;&nbsp;&nbsp;&nbsp;$meteo = Weather::Meteo-&gt;new(ua =&gt; $ua);

&nbsp;&nbsp;&nbsp;&nbsp;my $weather = $meteo-&gt;weather({ latitude =&gt; 51.34, longitude =&gt; 1.42, date =&gt; &#39;2022-12-25&#39; });
&nbsp;&nbsp;&nbsp;&nbsp;my @snowfall = @{$weather-&gt;{&#39;hourly&#39;}-&gt;{&#39;snowfall&#39;}};

&nbsp;&nbsp;&nbsp;&nbsp;print &#39;Number of cms of snow: &#39;, $snowfall[1], &quot;\n&quot;;

Creates a new instance. Acceptable options include:

=over 4

=item * C&lt;cache&gt;

A caching object.
If not provided,
an in-memory cache is created with a default expiration of one hour.

=item * C&lt;host&gt;

The API host endpoint.
Defaults to L&lt;https://archive-api.open-meteo.com&gt;.

=item * C&lt;min_interval&gt;

Minimum number of seconds to wait between API requests.
Defaults to C&lt;0&gt; (no delay).
Use this option to enforce rate-limiting.

=item * C&lt;ua&gt;

An object to use for HTTP requests.
If not provided, a default user agent is created.

=back

The class can be configured at runtime using environments and configuration files,
for example,
setting C&lt;$ENV{&#39;WEATHER__METEO__carp_on_warn&#39;}&gt; causes warnings to use L&lt;Carp&gt;.
For more information about runtime configuration,
see L&lt;Object::Configure&gt;.

=cut</pre></td></tr>
<tr><td class="h">122</td><td colspan="6"></td></tr><tr><td class="h">123</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">124</td><td><div class="c3">9</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L124">9</a></div></td><td><div>385846</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $class = shift;</td></tr>
<tr><td class="h">125</td><td><div class="c3">9</div></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--condition.html#L125">100</a></div></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $params = Params::Get::get_params(undef, \@_) || {};</td></tr>
<tr><td class="h">126</td><td colspan="6"></td></tr><tr><td class="h">127</td><td><div class="c3">9</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L127">100</a></div><div class="c3" title="T/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L127">100</a></div></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!defined($class)) {</td></tr>
<tr><td class="h">128</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Weather::Meteo::new() used rather than Weather::Meteo-&gt;new()</td></tr>
<tr><td class="h">129</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>1</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$class = __PACKAGE__;</td></tr>
<tr><td class="h">130</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif(Scalar::Util::blessed($class)) {</td></tr>
<tr><td class="h">131</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If $class is an object, clone it with new arguments</td></tr>
<tr><td class="h">132</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td><div>1</div><div>2</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return bless { %{$class}, %{$params} }, ref($class);</td></tr>
<tr><td class="h">133</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">134</td><td colspan="6"></td></tr><tr><td class="h">135</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params = Object::Configure::configure($class, $params);</td></tr>
<tr><td class="h">136</td><td colspan="6"></td></tr><tr><td class="h">137</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td><div>118100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $ua = $params-&gt;{ua};</td></tr>
<tr><td class="h">138</td><td><div class="c3">8</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L138">100</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!defined($ua)) {</td></tr>
<tr><td class="h">139</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ua = LWP::UserAgent-&gt;new(agent =&gt; __PACKAGE__ . &quot;/$VERSION&quot;);</td></tr>
<tr><td class="h">140</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td><div>5506</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ua-&gt;default_header(accept_encoding =&gt; &#39;gzip,deflate&#39;);</td></tr>
<tr><td class="h">141</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">142</td><td><div class="c3">8</div></td><td></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L142">50</a></div></td><td></td><td><div>195</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $host = $params-&gt;{host} || &#39;archive-api.open-meteo.com&#39;;</td></tr>
<tr><td class="h">143</td><td colspan="6"></td></tr><tr><td class="h">144</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set up caching (default to an in-memory cache if none provided)</td></tr>
<tr><td class="h">145</td><td><div class="c3">8</div></td><td></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L145">67</a></div></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cache = $params-&gt;{cache} || CHI-&gt;new(</td></tr>
<tr><td class="h">146</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;driver =&gt; &#39;Memory&#39;,</td></tr>
<tr><td class="h">147</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;global =&gt; 1,</td></tr>
<tr><td class="h">148</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;expires_in =&gt; EXPIRES_IN,</td></tr>
<tr><td class="h">149</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">150</td><td colspan="6"></td></tr><tr><td class="h">151</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Set up rate-limiting: minimum interval between requests (in seconds)</td></tr>
<tr><td class="h">152</td><td><div class="c3">8</div></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--condition.html#L152">100</a></div></td><td></td><td><div>177690</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $min_interval = $params-&gt;{min_interval} || MIN_INTERVAL;</td></tr>
<tr><td class="h">153</td><td colspan="6"></td></tr><tr><td class="h">154</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return bless {</td></tr>
<tr><td class="h">155</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_interval =&gt; $min_interval,</td></tr>
<tr><td class="h">156</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;last_request =&gt; 0,&nbsp;&nbsp;&nbsp;# Initialize last_request timestamp</td></tr>
<tr><td class="h">157</td><td><div class="c3">8</div><div class="c3">8</div></td><td></td><td></td><td></td><td><div>7</div><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{$params},</td></tr>
<tr><td class="h">158</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cache =&gt; $cache,</td></tr>
<tr><td class="h">159</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host =&gt; $host,</td></tr>
<tr><td class="h">160</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ua =&gt; $ua</td></tr>
<tr><td class="h">161</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}, $class;</td></tr>
<tr><td class="h">162</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">163</td><td colspan="6"></td></tr><tr><td class="h">164 - 187</td><td colspan="5"></td><td class="s"><pre>=head2 weather

&nbsp;&nbsp;&nbsp;&nbsp;use Geo::Location::Point;

&nbsp;&nbsp;&nbsp;&nbsp;my $ramsgate = Geo::Location::Point-&gt;new({ latitude =&gt; 51.34, longitude =&gt; 1.42 });
&nbsp;&nbsp;&nbsp;&nbsp;# Print snowfall at 1AM on Christmas morning in Ramsgate
&nbsp;&nbsp;&nbsp;&nbsp;$weather = $meteo-&gt;weather($ramsgate, &#39;2022-12-25&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;@snowfall = @{$weather-&gt;{&#39;hourly&#39;}-&gt;{&#39;snowfall&#39;}};

&nbsp;&nbsp;&nbsp;&nbsp;print &#39;Number of cms of snow: &#39;, $snowfall[1], &quot;\n&quot;;

&nbsp;&nbsp;&nbsp;&nbsp;use DateTime;
&nbsp;&nbsp;&nbsp;&nbsp;my $dt = DateTime-&gt;new(year =&gt; 2024, month =&gt; 2, day =&gt; 1);
&nbsp;&nbsp;&nbsp;&nbsp;$weather = $meteo-&gt;weather({ location =&gt; $ramsgate, date =&gt; $dt });

The date argument can be an ISO-8601 formatted date,
or an object that understands the strftime method.

Takes an optional argument, tz, containing the time zone.
If not given, the module tries to work it out from the given location,
for that to work set TIMEZONEDB_KEY to be your API key from L&lt;https://timezonedb.com&gt;.
If all else fails, the module falls back to Europe/London.

=cut</pre></td></tr>
<tr><td class="h">188</td><td colspan="6"></td></tr><tr><td class="h">189</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub weather</td></tr>
<tr><td class="h">190</td><td></td><td></td><td></td><td></td><td></td><td class="s">{</td></tr>
<tr><td class="h">191</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L191">8</a></div></td><td><div>2714</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">192</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $params;</td></tr>
<tr><td class="h">193</td><td colspan="6"></td></tr><tr><td class="h">194</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L194">50</a></div></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L194">25</a></div></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((scalar(@_) == 2) &amp;&amp; Scalar::Util::blessed($_[0]) &amp;&amp; ($_[0]-&gt;can(&#39;latitude&#39;))) {</td></tr>
<tr><td class="h">195</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Two arguments - a location object and a date</td></tr>
<tr><td class="h">196</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $location = $_[0];</td></tr>
<tr><td class="h">197</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params-&gt;{latitude} = $location-&gt;latitude();</td></tr>
<tr><td class="h">198</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params-&gt;{longitude} = $location-&gt;longitude();</td></tr>
<tr><td class="h">199</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params-&gt;{&#39;date&#39;} = $_[1];</td></tr>
<tr><td class="h">200</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Weather-Meteo-pm--branch.html#L200">0</a></div></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L200">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_[0]-&gt;can(&#39;tz&#39;) &amp;&amp; $ENV{&#39;TIMEZONEDB_KEY&#39;}) {</td></tr>
<tr><td class="h">201</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params-&gt;{&#39;tz&#39;} = $_[0]-&gt;tz();</td></tr>
<tr><td class="h">202</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">203</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">204</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params = Params::Get::get_params(undef, \@_);</td></tr>
<tr><td class="h">205</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">206</td><td colspan="6"></td></tr><tr><td class="h">207</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td><div>93</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $latitude = $params-&gt;{latitude};</td></tr>
<tr><td class="h">208</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $longitude = $params-&gt;{longitude};</td></tr>
<tr><td class="h">209</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $location = $params-&gt;{&#39;location&#39;};</td></tr>
<tr><td class="h">210</td><td><div class="c3">8</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $date = $params-&gt;{&#39;date&#39;};</td></tr>
<tr><td class="h">211</td><td><div class="c3">8</div></td><td></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L211">50</a></div></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $tz = $params-&gt;{&#39;tz&#39;} || &#39;Europe/London&#39;;</td></tr>
<tr><td class="h">212</td><td colspan="6"></td></tr><tr><td class="h">213</td><td><div class="c3">8</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Weather-Meteo-pm--branch.html#L213">0</a></div></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L213">40</a></div></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((!defined($latitude)) &amp;&amp; defined($location) &amp;&amp;</td></tr>
<tr><td class="h">214</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Scalar::Util::blessed($location) &amp;&amp; $location-&gt;can(&#39;latitude&#39;)) {</td></tr>
<tr><td class="h">215</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$latitude = $location-&gt;latitude();</td></tr>
<tr><td class="h">216</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$longitude = $location-&gt;longitude();</td></tr>
<tr><td class="h">217</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">218</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L218">50</a></div></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L218">50</a></div></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((!defined($latitude)) || (!defined($longitude)) || (!defined($date))) {</td></tr>
<tr><td class="h">219</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Weather-Meteo-pm--branch.html#L219">50</a></div></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(my $logger = $self-&gt;{&#39;logger&#39;}) {</td></tr>
<tr><td class="h">220</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$logger-&gt;error(&#39;Usage: weather(latitude =&gt; $latitude, longitude =&gt; $longitude, date =&gt; &quot;YYYY-MM-DD&quot;)&#39;);</td></tr>
<tr><td class="h">221</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">222</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>2132</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Carp::croak(&#39;Usage: weather(latitude =&gt; $latitude, longitude =&gt; $longitude, date =&gt; &quot;YYYY-MM-DD&quot;)&#39;);</td></tr>
<tr><td class="h">223</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">224</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">225</td><td colspan="6"></td></tr><tr><td class="h">226</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Handle numbers starting with a decimal point</td></tr>
<tr><td class="h">227</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L227">50</a></div></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($latitude =~ /^\./) {</td></tr>
<tr><td class="h">228</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$latitude = &quot;0$latitude&quot;;</td></tr>
<tr><td class="h">229</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">230</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L230">50</a></div></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($latitude =~ /^\-\.(\d+)$/) {</td></tr>
<tr><td class="h">231</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$latitude = &quot;-0.$1&quot;;</td></tr>
<tr><td class="h">232</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">233</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L233">50</a></div></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($longitude =~ /^\./) {</td></tr>
<tr><td class="h">234</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$longitude = &quot;0$longitude&quot;;</td></tr>
<tr><td class="h">235</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">236</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L236">50</a></div></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($longitude =~ /^\-\.(\d+)$/) {</td></tr>
<tr><td class="h">237</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$longitude = &quot;-0.$1&quot;;</td></tr>
<tr><td class="h">238</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">239</td><td colspan="6"></td></tr><tr><td class="h">240</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L240">50</a></div></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L240">33</a></div></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(($latitude !~ /^-?\d+(\.\d+)?$/) || ($longitude !~ /^-?\d+(\.\d+)?$/)) {</td></tr>
<tr><td class="h">241</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Weather-Meteo-pm--branch.html#L241">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(my $logger = $self-&gt;{&#39;logger&#39;}) {</td></tr>
<tr><td class="h">242</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;error(__PACKAGE__ . &quot;: Invalid latitude/longitude format ($latitude, $longitude)&quot;);</td></tr>
<tr><td class="h">243</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">244</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Carp::croak(__PACKAGE__, &quot;: Invalid latitude/longitude format ($latitude, $longitude)&quot;);</td></tr>
<tr><td class="h">245</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">246</td><td colspan="6"></td></tr><tr><td class="h">247</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L247">50</a></div><div class="c3" title="T/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L247">100</a></div></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--condition.html#L247">33</a></div></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Scalar::Util::blessed($date) &amp;&amp; $date-&gt;can(&#39;strftime&#39;)) {</td></tr>
<tr><td class="h">248</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$date = $date-&gt;strftime(&#39;%F&#39;);</td></tr>
<tr><td class="h">249</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif($date =~ /^(\d{4})-/) {</td></tr>
<tr><td class="h">250</td><td><div class="c3">5</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L250">100</a></div></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return if($1 &lt; FIRST_YEAR);</td></tr>
<tr><td class="h">251</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">252</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Carp::carp(&quot;&#39;$date&#39; is not a valid date&quot;);</td></tr>
<tr><td class="h">253</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>142</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">254</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">255</td><td colspan="6"></td></tr><tr><td class="h">256</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L256">50</a></div></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless($date =~ /^\d{4}-\d{2}-\d{2}$/) {</td></tr>
<tr><td class="h">257</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Weather-Meteo-pm--branch.html#L257">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(my $logger = $self-&gt;{&#39;logger&#39;}) {</td></tr>
<tr><td class="h">258</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;error(&#39;Invalid date format. Expected YYYY-MM-DD&#39;);</td></tr>
<tr><td class="h">259</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">260</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;croak(&#39;Invalid date format. Expected YYYY-MM-DD&#39;);</td></tr>
<tr><td class="h">261</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">262</td><td colspan="6"></td></tr><tr><td class="h">263</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $uri = URI-&gt;new(&quot;https://$self-&gt;{host}/v1/archive&quot;);</td></tr>
<tr><td class="h">264</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>7832</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %query_parameters = (</td></tr>
<tr><td class="h">265</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;latitude&#39; =&gt; $latitude,</td></tr>
<tr><td class="h">266</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;longitude&#39; =&gt; $longitude,</td></tr>
<tr><td class="h">267</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;start_date&#39; =&gt; $date,</td></tr>
<tr><td class="h">268</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;end_date&#39; =&gt; $date,</td></tr>
<tr><td class="h">269</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;hourly&#39; =&gt; &#39;temperature_2m,rain,snowfall,weathercode&#39;,</td></tr>
<tr><td class="h">270</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;daily&#39; =&gt; &#39;weathercode,temperature_2m_max,temperature_2m_min,rain_sum,snowfall_sum,precipitation_hours,windspeed_10m_max,windgusts_10m_max&#39;,</td></tr>
<tr><td class="h">271</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;timezone&#39; =&gt; $tz,</td></tr>
<tr><td class="h">272</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# https://stackoverflow.com/questions/16086962/how-to-get-a-time-zone-from-a-location-using-latitude-and-longitude-coordinates</td></tr>
<tr><td class="h">273</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;windspeed_unit&#39; =&gt; &#39;mph&#39;,</td></tr>
<tr><td class="h">274</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;precipitation_unit&#39; =&gt; &#39;inch&#39;</td></tr>
<tr><td class="h">275</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">276</td><td colspan="6"></td></tr><tr><td class="h">277</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uri-&gt;query_form(%query_parameters);</td></tr>
<tr><td class="h">278</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>578</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $url = $uri-&gt;as_string();</td></tr>
<tr><td class="h">279</td><td colspan="6"></td></tr><tr><td class="h">280</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$url =~ s/%2C/,/g;</td></tr>
<tr><td class="h">281</td><td colspan="6"></td></tr><tr><td class="h">282</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Create a cache key based on the location, date and time zone (might want to use a stronger hash function if needed)</td></tr>
<tr><td class="h">283</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $cache_key = &quot;weather:$latitude:$longitude:$date:$tz&quot;;</td></tr>
<tr><td class="h">284</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L284">50</a></div></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(my $cached = $self-&gt;{cache}-&gt;get($cache_key)) {</td></tr>
<tr><td class="h">285</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $cached;</td></tr>
<tr><td class="h">286</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">287</td><td colspan="6"></td></tr><tr><td class="h">288</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Enforce rate-limiting: ensure at least min_interval seconds between requests</td></tr>
<tr><td class="h">289</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>226</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $now = time();</td></tr>
<tr><td class="h">290</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $elapsed = $now - $self-&gt;{last_request};</td></tr>
<tr><td class="h">291</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L291">100</a></div></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($elapsed &lt; $self-&gt;{min_interval}) {</td></tr>
<tr><td class="h">292</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>1000175</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time::HiRes::sleep($self-&gt;{min_interval} - $elapsed);</td></tr>
<tr><td class="h">293</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">294</td><td colspan="6"></td></tr><tr><td class="h">295</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $res = $self-&gt;{ua}-&gt;get($url);</td></tr>
<tr><td class="h">296</td><td colspan="6"></td></tr><tr><td class="h">297</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Update last_request timestamp</td></tr>
<tr><td class="h">298</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>216</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{last_request} = time();</td></tr>
<tr><td class="h">299</td><td colspan="6"></td></tr><tr><td class="h">300</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L300">50</a></div></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($res-&gt;is_error()) {</td></tr>
<tr><td class="h">301</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Carp::carp(ref($self), &quot;: $url API returned error: &quot;, $res-&gt;status_line());</td></tr>
<tr><td class="h">302</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">303</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">304</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# $res-&gt;content_type(&#39;text/plain&#39;);&nbsp;&nbsp;# May be needed to decode correctly</td></tr>
<tr><td class="h">305</td><td colspan="6"></td></tr><tr><td class="h">306</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $rc;</td></tr>
<tr><td class="h">307</td><td><div class="c3">4</div><div class="c3">4</div></td><td></td><td></td><td></td><td><div>4</div><div>49</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval { $rc = JSON::MaybeXS-&gt;new()-&gt;utf8()-&gt;decode($res-&gt;decoded_content()) };</td></tr>
<tr><td class="h">308</td><td><div class="c3">4</div></td><td><div class="c3" title="T/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L308">100</a></div></td><td></td><td></td><td><div>648</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($@) {</td></tr>
<tr><td class="h">309</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Carp::carp(&quot;Failed to parse JSON response: $@&quot;);</td></tr>
<tr><td class="h">310</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>434</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">311</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">312</td><td colspan="6"></td></tr><tr><td class="h">313</td><td><div class="c3">3</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Weather-Meteo-pm--branch.html#L313">50</a></div></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($rc) {</td></tr>
<tr><td class="h">314</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="blib-lib-Weather-Meteo-pm--branch.html#L314">50</a></div></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($rc-&gt;{&#39;error&#39;}) {</td></tr>
<tr><td class="h">315</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# TODO: print error code</td></tr>
<tr><td class="h">316</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">317</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">318</td><td><div class="c3">3</div></td><td><div class="c0" title="T/-"><a href="blib-lib-Weather-Meteo-pm--branch.html#L318">50</a></div></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined($rc-&gt;{&#39;hourly&#39;})) {</td></tr>
<tr><td class="h">319</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Cache the result before returning it</td></tr>
<tr><td class="h">320</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;cache&#39;}-&gt;set($cache_key, $rc);</td></tr>
<tr><td class="h">321</td><td colspan="6"></td></tr><tr><td class="h">322</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>791</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return Return::Set::set_return($rc, { type =&gt; &#39;hashref&#39;, min =&gt; 1 });&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# No support for list context, yet</td></tr>
<tr><td class="h">323</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">324</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">325</td><td colspan="6"></td></tr><tr><td class="h">326</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# my @results = @{ $data || [] };</td></tr>
<tr><td class="h">327</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# wantarray ? @results : $results[0];</td></tr>
<tr><td class="h">328</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">329</td><td colspan="6"></td></tr><tr><td class="h">330 - 346</td><td colspan="5"></td><td class="s"><pre>=head2 ua

Accessor method to get and set UserAgent object used internally. You
can call I&lt;env_proxy&gt; for example, to get the proxy information from
environment variables:

&nbsp;&nbsp;&nbsp;&nbsp;$meteo-&gt;ua()-&gt;env_proxy(1);

You can also set your own User-Agent object:

&nbsp;&nbsp;&nbsp;&nbsp;use LWP::UserAgent::Throttled;

&nbsp;&nbsp;&nbsp;&nbsp;my $ua = LWP::UserAgent::Throttled-&gt;new();
&nbsp;&nbsp;&nbsp;&nbsp;$ua-&gt;throttle(&#39;open-meteo.com&#39; =&gt; 1);
&nbsp;&nbsp;&nbsp;&nbsp;$meteo-&gt;ua($ua);

=cut</pre></td></tr>
<tr><td class="h">347</td><td colspan="6"></td></tr><tr><td class="h">348</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub ua {</td></tr>
<tr><td class="h">349</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="blib-lib-Weather-Meteo-pm--subroutine.html#L349">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">350</td><td colspan="6"></td></tr><tr><td class="h">351</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="blib-lib-Weather-Meteo-pm--branch.html#L351">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (@_) {</td></tr>
<tr><td class="h">352</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{ua} = shift;</td></tr>
<tr><td class="h">353</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">354</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{ua}</td></tr>
<tr><td class="h">355</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">356</td><td colspan="6"></td></tr><tr><td class="h">357 - 426</td><td colspan="5"></td><td class="s"><pre>=head1 AUTHOR

Nigel Horne, C&lt;&lt; &lt;njh@nigelhorne.com&gt; &gt;&gt;

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.

Lots of thanks to the folks at L&lt;https://open-meteo.com&gt;.

=head1 BUGS

Please report any bugs or feature requests to C&lt;bug-weather-meteo at rt.cpan.org&gt;,
or through the web interface at
L&lt;http://rt.cpan.org/NoAuth/ReportBug.html?Queue=Weather-Meteo&gt;.
I will be notified, and then you&#39;ll
automatically be notified of progress on your bug as I make changes.

=head1 SEE ALSO

=over 4

=item * Test coverage report: L&lt;https://nigelhorne.github.io/Weather-Meteo/coverage/&gt;

=item * Open Meteo API: L&lt;https://open-meteo.com/en/docs#api_form&gt;

=item * L&lt;Object::Configure&gt;

=back

=head1 SUPPORT

This module is provided as-is without any warranty.

You can find documentation for this module with the perldoc command.

&nbsp;&nbsp;&nbsp;&nbsp;perldoc Weather::Meteo

You can also look for information at:

=over 4

=item * MetaCPAN

L&lt;https://metacpan.org/release/Weather-Meteo&gt;

=item * RT: CPAN&#39;s request tracker

L&lt;https://rt.cpan.org/NoAuth/Bugs.html?Dist=Weather-Meteo&gt;

=item * CPANTS

L&lt;http://cpants.cpanauthors.org/dist/Weather-Meteo&gt;

=item * CPAN Testers&#39; Matrix

L&lt;http://matrix.cpantesters.org/?dist=Weather-Meteo&gt;

=item * CPAN Testers Dependencies

L&lt;http://deps.cpantesters.org/?module=Weather-Meteo&gt;

=back

=head1 LICENSE AND COPYRIGHT

Copyright 2023-2025 Nigel Horne.

This program is released under the following licence: GPL2

=cut</pre></td></tr>
<tr><td class="h">427</td><td colspan="6"></td></tr><tr><td class="h">428</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
